<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}} - Hertz MVC框架</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/style.css" rel="stylesheet">
    <link href="/static/css/markdown-docsify.css" rel="stylesheet">
    <!-- Markdown 样式（内联以避免静态文件服务问题） -->
    <style>
/* 基础Markdown样式 */
.markdown-content {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    line-height: 1.6;
    color: #333;
    max-width: 100%;
    word-wrap: break-word;
}

/* 标题样式 */
.markdown-content h1, .markdown-content h2, .markdown-content h3,
.markdown-content h4, .markdown-content h5, .markdown-content h6 {
    margin: 20px 0 10px 0;
    color: #333;
    font-weight: 600;
}

.markdown-content h1 { font-size: 2em; border-bottom: 2px solid #667eea; padding-bottom: 10px; }
.markdown-content h2 { font-size: 1.5em; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.markdown-content h3 { font-size: 1.3em; margin: 18px 0 8px 0; }

/* 段落和链接 */
.markdown-content p { margin: 15px 0; }
.markdown-content a { color: #667eea; text-decoration: none; transition: all 0.3s ease; }
.markdown-content a:hover { color: #5a6fd8; border-bottom: 1px solid #5a6fd8; }

/* 强调文本 */
.markdown-content strong { font-weight: 600; color: #2d3748; }
.markdown-content em { font-style: italic; color: #4a5568; }

/* 代码样式 */
.markdown-content code {
    background: #e2e8f0; color: #2d3748; padding: 3px 6px; border-radius: 4px;
    font-family: 'Fira Code', 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; font-size: 0.85em;
}

.markdown-content pre {
    background: #1a202c; color: #e2e8f0; border-radius: 8px; padding: 20px;
    overflow-x: auto; margin: 20px 0; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    position: relative; line-height: 1.4;
}

.markdown-content pre code {
    background: transparent; color: inherit; padding: 0; border-radius: 0;
    font-size: 0.9em; white-space: pre; display: block;
}

/* 语言特定边框 */
.markdown-content pre.language-go, .markdown-content pre.language-golang { border-left: 4px solid #00add8; }
.markdown-content pre.language-javascript, .markdown-content pre.language-js { border-left: 4px solid #f7df1e; }
.markdown-content pre.language-python { border-left: 4px solid #3776ab; }
.markdown-content pre.language-bash, .markdown-content pre.language-shell { border-left: 4px solid #4eaa25; }
.markdown-content pre.language-yaml, .markdown-content pre.language-yml { border-left: 4px solid #cb171e; }
.markdown-content pre.language-json { border-left: 4px solid #292929; }
.markdown-content pre.language-html { border-left: 4px solid #e34c26; }
.markdown-content pre.language-css { border-left: 4px solid #1572b6; }

/* 列表样式 */
.markdown-content ul, .markdown-content ol { margin: 16px 0; padding-left: 32px; }
.markdown-content li { margin: 8px 0; line-height: 1.6; }
.markdown-content ul li { list-style-type: none; position: relative; }
.markdown-content ul li::before { content: "•"; color: #667eea; font-size: 1.2em; position: absolute; left: -20px; }

/* 表格样式 */
.markdown-content table { border-collapse: collapse; width: 100%; margin: 20px 0; border-radius: 8px; overflow: hidden; }
.markdown-content th { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-weight: 600; padding: 15px 12px; }
.markdown-content td { border: 1px solid #e2e8f0; padding: 12px; background: white; }
.markdown-content tr:nth-child(even) td { background: #f7fafc; }

/* 引用块 */
.markdown-content blockquote {
    border-left: 4px solid #667eea; margin: 20px 0; padding: 15px 25px;
    background: linear-gradient(to right, #f7fafc, #ffffff); border-radius: 0 8px 8px 0;
}

/* 示例块样式 */
.markdown-content .example-block {
    background: linear-gradient(135deg, #e6f3ff 0%, #f0f8ff 100%);
    border: 1px solid #b3d9ff; border-left: 4px solid #007acc;
    border-radius: 8px; padding: 20px; margin: 20px 0; position: relative;
}
.markdown-content .example-block::before {
    content: "💡 示例"; position: absolute; top: -10px; left: 15px;
    background: #007acc; color: white; padding: 4px 12px; border-radius: 4px;
    font-size: 0.8em; font-weight: 600;
}

/* 警告块样式 */
.markdown-content .warning-block {
    background: linear-gradient(135deg, #fff3cd 0%, #fefcf3 100%);
    border: 1px solid #ffeaa7; border-left: 4px solid #fdcb6e;
    border-radius: 8px; padding: 20px; margin: 20px 0; position: relative;
}
.markdown-content .warning-block::before {
    content: "⚠️ 警告"; position: absolute; top: -10px; left: 15px;
    background: #fdcb6e; color: #2d3436; padding: 4px 12px; border-radius: 4px;
    font-size: 0.8em; font-weight: 600;
}

/* 提示块样式 */
.markdown-content .info-block {
    background: linear-gradient(135deg, #e8f5e8 0%, #f8fff8 100%);
    border: 1px solid #a8e6a8; border-left: 4px solid #27ae60;
    border-radius: 8px; padding: 20px; margin: 20px 0; position: relative;
}
.markdown-content .info-block::before {
    content: "ℹ️ 提示"; position: absolute; top: -10px; left: 15px;
    background: #27ae60; color: white; padding: 4px 12px; border-radius: 4px;
    font-size: 0.8em; font-weight: 600;
}

/* 响应式 */
@media (max-width: 768px) {
    .markdown-content { font-size: 16px; line-height: 1.7; }
    .markdown-content h1 { font-size: 1.8em; }
    .markdown-content h2 { font-size: 1.4em; }
    .markdown-content pre { padding: 15px; margin: 15px -15px; border-radius: 0; }
}
    </style>
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Prism.js 语法高亮 -->
    <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <!-- Markdown主题切换器样式将通过JavaScript动态加载 -->
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-bolt"></i> Hertz MVC
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/">首页</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/home/docs">文档</a>
                    </li>
                    <!-- <li class="nav-item">
                        <a class="nav-link" href="/user">用户管理</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/admin/dashboard">管理后台</a>
                    </li> -->
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/home/about">关于</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- 页面标题 -->
    <div class="bg-primary text-white py-4">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <h1 class="mb-0">
                        <i class="fas fa-book me-2"></i>{{.Title}}
                    </h1>
                    <p class="lead mb-0 mt-2">Hertz MVC框架开发文档和指南</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 面包屑导航 -->
    <div class="bg-light py-2">
        <div class="container">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb mb-0">
                    <li class="breadcrumb-item"><a href="/">首页</a></li>
                    <li class="breadcrumb-item"><a href="/home/docs">文档</a></li>
                    <li class="breadcrumb-item active" aria-current="page">{{.Title}}</li>
                </ol>
            </nav>
        </div>
    </div>

    <!-- 主要内容 -->
    <div class="container my-5">
        <div class="row">
            <!-- 侧边栏导航 -->
            <div class="col-lg-3 mb-4">
                {{template "docs-sidebar" .}}
            </div>

            <!-- 文档内容 -->
            <div class="col-lg-9">
                <div class="card">
                    <div class="card-body">
                        <div class="markdown-content" id="markdown-preview">
                            {{.Content}}
                        </div>
                    </div>
                </div>

                <!-- 页面导航 -->
                <div class="row mt-4">
                    <div class="col-6">
                        {{if eq .CurrentDoc "quickstart"}}
                        <a href="/home/docs" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left me-2"></i>文档首页
                        </a>
                        {{else if eq .CurrentDoc "controller"}}
                        <a href="/home/quickstart" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left me-2"></i>快速开始
                        </a>
                        {{else if eq .CurrentDoc "routing"}}
                        <a href="/home/controller" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left me-2"></i>控制器
                        </a>
                        {{else if eq .CurrentDoc "middleware"}}
                        <a href="/home/routing" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left me-2"></i>路由系统
                        </a>
                        {{else if eq .CurrentDoc "template"}}
                        <a href="/home/middleware" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left me-2"></i>中间件
                        </a>
                        {{else if eq .CurrentDoc "database"}}
                        <a href="/home/template" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left me-2"></i>模板引擎
                        </a>
                        {{else if eq .CurrentDoc "deployment"}}
                        <a href="/home/database" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left me-2"></i>数据库集成
                        </a>
                        {{end}}
                    </div>
                    <div class="col-6 text-end">
                        {{if eq .CurrentDoc "quickstart"}}
                        <a href="/home/controller" class="btn btn-outline-primary">
                            控制器 <i class="fas fa-arrow-right ms-2"></i>
                        </a>
                        {{else if eq .CurrentDoc "controller"}}
                        <a href="/home/routing" class="btn btn-outline-primary">
                            路由系统 <i class="fas fa-arrow-right ms-2"></i>
                        </a>
                        {{else if eq .CurrentDoc "routing"}}
                        <a href="/home/middleware" class="btn btn-outline-primary">
                            中间件 <i class="fas fa-arrow-right ms-2"></i>
                        </a>
                        {{else if eq .CurrentDoc "middleware"}}
                        <a href="/home/template" class="btn btn-outline-primary">
                            模板引擎 <i class="fas fa-arrow-right ms-2"></i>
                        </a>
                        {{else if eq .CurrentDoc "template"}}
                        <a href="/home/database" class="btn btn-outline-primary">
                            数据库集成 <i class="fas fa-arrow-right ms-2"></i>
                        </a>
                        {{else if eq .CurrentDoc "database"}}
                        <a href="/home/deployment" class="btn btn-outline-primary">
                            部署上线 <i class="fas fa-arrow-right ms-2"></i>
                        </a>
                        {{end}}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 页脚 -->
    <footer class="bg-dark text-white py-4 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>Hertz MVC Framework</h5>
                    <p class="text-muted">基于CloudWeGo-Hertz构建的高性能Go Web框架</p>
                </div>
                <div class="col-md-6">
                    <h5>链接</h5>
                    <ul class="list-unstyled">
                        <li><a href="/home/docs" class="text-muted">文档</a></li>
                        <li><a href="https://github.com/zsy619/yyhertz" class="text-muted">GitHub</a></li>
                        <li><a href="/home/about" class="text-muted">关于我们</a></li>
                    </ul>
                </div>
            </div>
            <hr class="my-4">
            <div class="text-center">
                <p class="mb-0">© 2024 元曜. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Prism.js 语法高亮 -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <!-- Markdown主题切换器 -->
    <script src="/static/js/markdown-theme-switcher.js"></script>
    <script>
        // 处理已渲染的Markdown内容
        document.addEventListener('DOMContentLoaded', function() {
            const previewElement = document.getElementById('markdown-preview');
            if (previewElement) {
                // 应用语法高亮
                if (typeof Prism !== 'undefined') {
                    Prism.highlightAllUnder(previewElement);
                }
                
                // 处理图片
                processImages(previewElement);
                
                // 添加标题锚点
                addHeadingAnchors(previewElement);
                
                // 为代码块添加复制按钮
                addCopyButtons(previewElement);
            }
            console.log('文档页面加载完成');

            // 平滑滚动到锚点
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
        });

        // 处理图片功能
        function processImages(container) {
            const images = container.querySelectorAll('img');
            images.forEach(function(img) {
                // 添加懒加载
                if (!img.hasAttribute('loading')) {
                    img.setAttribute('loading', 'lazy');
                }
                
                // 图片错误处理
                img.addEventListener('error', function() {
                    this.style.display = 'none';
                    const placeholder = document.createElement('div');
                    placeholder.className = 'image-placeholder';
                    placeholder.innerHTML = '<i class="fas fa-image"></i> 图片加载失败';
                    placeholder.style.cssText = `
                        background: #f8f9fa;
                        color: #6c757d;
                        padding: 40px;
                        text-align: center;
                        border: 2px dashed #dee2e6;
                        border-radius: 8px;
                        margin: 15px 0;
                    `;
                    this.parentNode.insertBefore(placeholder, this);
                });
                
                // 图片点击放大
                img.addEventListener('click', function() {
                    openImageModal(this.src, this.alt);
                });
            });
        }

        // 添加标题锚点
        function addHeadingAnchors(container) {
            const headings = container.querySelectorAll('h1, h2, h3, h4, h5, h6');
            headings.forEach(function(heading) {
                const id = heading.textContent.toLowerCase()
                    .replace(/[^\w\s-]/g, '')
                    .replace(/\s+/g, '-')
                    .trim();
                    
                heading.setAttribute('id', id);
                
                const anchor = document.createElement('a');
                anchor.className = 'anchor';
                anchor.href = '#' + id;
                anchor.title = '链接到此标题';
                heading.appendChild(anchor);
            });
        }

        // 为代码块添加复制按钮
        function addCopyButtons(container) {
            container.querySelectorAll('pre code').forEach(function(codeBlock) {
                const pre = codeBlock.parentNode;
                
                // 避免重复添加按钮
                if (pre.querySelector('.copy-button')) return;
                
                const button = document.createElement('button');
                button.className = 'btn btn-sm btn-outline-light copy-button position-absolute top-0 end-0 m-2';
                button.innerHTML = '<i class="fas fa-copy"></i>';
                button.title = '复制代码';
                pre.style.position = 'relative';
                pre.appendChild(button);
                
                button.addEventListener('click', function() {
                    const text = codeBlock.textContent;
                    if (navigator.clipboard) {
                        navigator.clipboard.writeText(text).then(function() {
                            button.innerHTML = '<i class="fas fa-check text-success"></i>';
                            setTimeout(function() {
                                button.innerHTML = '<i class="fas fa-copy"></i>';
                            }, 2000);
                        }).catch(function() {
                            fallbackCopyTextToClipboard(text, button);
                        });
                    } else {
                        fallbackCopyTextToClipboard(text, button);
                    }
                });
            });
        }

        // 备用复制方法
        function fallbackCopyTextToClipboard(text, button) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed";
            textArea.style.left = "-999999px";
            textArea.style.top = "-999999px";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                document.execCommand('copy');
                button.innerHTML = '<i class="fas fa-check text-success"></i>';
                setTimeout(function() {
                    button.innerHTML = '<i class="fas fa-copy"></i>';
                }, 2000);
            } catch (err) {
                console.error('复制失败:', err);
            }
            
            document.body.removeChild(textArea);
        }

        // 图片模态框
        function openImageModal(src, alt) {
            const modal = document.createElement('div');
            modal.className = 'image-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                z-index: 9999;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: zoom-out;
            `;
            
            const img = document.createElement('img');
            img.src = src;
            img.alt = alt;
            img.style.cssText = `
                max-width: 90%;
                max-height: 90%;
                border-radius: 8px;
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            `;
            
            modal.appendChild(img);
            document.body.appendChild(modal);
            
            modal.addEventListener('click', function() {
                document.body.removeChild(modal);
            });
            
            // ESC键关闭
            const closeOnEsc = function(e) {
                if (e.key === 'Escape') {
                    document.body.removeChild(modal);
                    document.removeEventListener('keydown', closeOnEsc);
                }
            };
            document.addEventListener('keydown', closeOnEsc);
        }
    </script>
</body>
</html>